# Pokemon Marketplace

A modern, secure marketplace for buying and selling Pokemon trading cards built with Next.js.

## üöÄ Features

- **Secure Trading**: Escrow-protected transactions with buyer/seller verification
- **Responsive Design**: Optimized for desktop, tablet, and mobile browsers
- **Advanced Search**: Filter by set, rarity, condition, and price
- **Authentication**: Secure user registration with role-based access
- **Payment Processing**: Integrated payment system with seller payouts

## üõ†Ô∏è Tech Stack

- **Frontend**: Next.js 15, TypeScript, Tailwind CSS
- **Authentication**: Auth0 with Next.js
- **Database**: PostgreSQL with Prisma ORM
- **Payments**: Stripe Connect for marketplace transactions
- **Hosting**: Vercel

## üì± Getting Started

### Prerequisites

- Node.js 18+
- npm or yarn
- **Vercel CLI**: `npm install -g vercel`
- Access to the pokemonmarketplace Vercel team (contact team lead)
- Auth0 account credentials (get from team lead)

### Setup Instructions

#### 1. Clone and Install

```bash
# Clone the repository
git clone https://github.com/markbello/pokemon-marketplace.git
cd pokemon-marketplace

# Install dependencies
npm install
```

#### 2. Environment Variables

**Important**: All environment variables must be set up using Vercel CLI to ensure database connections are configured correctly.

```bash
# Link your local project to Vercel project
vercel link

# Pull environment variables from Vercel (creates .env.development.local)
vercel env pull
```

**Copy DATABASE_URL to .env.local:**

After running `vercel env pull`, you'll get a `.env.development.local` file. Copy the `DATABASE_URL` from that file to your `.env.local` file (create it if it doesn't exist).

Your `.env.local` should contain:

```bash
# Auth0 Configuration (get from team lead)
AUTH0_SECRET="[get-from-team-lead]"
AUTH0_BASE_URL="http://localhost:3000"
AUTH0_ISSUER_BASE_URL="[get-from-team-lead]"
AUTH0_CLIENT_ID="[get-from-team-lead]"
AUTH0_CLIENT_SECRET="[get-from-team-lead]"
AUTH0_DOMAIN="[get-from-team-lead]"
AUTH0_MANAGEMENT_CLIENT_ID="[get-from-team-lead]"
AUTH0_MANAGEMENT_CLIENT_SECRET="[get-from-team-lead]"

# Database - Copied from .env.development.local (Vercel CLI output)
DATABASE_URL="postgresql://[copied-from-vercel-output]"

# Other environment variables...
```

**Note**: Vercel automatically provides `DATABASE_URL` for preview and production deployments. Local development uses the staging database connection string.

#### 3. Database Setup

```bash
# Generate Prisma client
npm run db:generate

# Create and apply initial migration
npm run db:migrate -- --name init

# (Optional) Seed database with test data
npm run db:seed
```

#### 4. Start Development

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

## üóÑÔ∏è Development Commands

### Database Operations (Always use these scripts)

**Important**: Always use `npm run db:*` scripts, never direct `npx prisma` commands. The scripts ensure `.env.local` is properly loaded.

- `npm run db:migrate` - Create and apply new migrations (e.g., `npm run db:migrate -- --name add_user_table`)
- `npm run db:generate` - Regenerate Prisma client after schema changes
- `npm run db:studio` - Open Prisma Studio (database GUI) to view/edit data
- `npm run db:seed` - Seed database with test data
- `npm run db:reset` - Reset database (‚ö†Ô∏è **WARNING**: deletes all data)
- `npm run db:deploy` - Apply migrations to remote database (production)

### Next.js

- `npm run dev` - Start development server
- `npm run build` - Build for production
- `npm run start` - Start production server
- `npm run lint` - Run ESLint
- `npm run lint:fix` - Fix ESLint errors
- `npm run format` - Format code with Prettier
- `npm run format:check` - Check code formatting

## üîß Troubleshooting

### "Environment variable not found: DATABASE_URL"

- Make sure you copied `DATABASE_URL` from `.env.development.local` to `.env.local`
- Always use `npm run db:*` scripts, not direct `npx prisma` commands
- The scripts use `dotenv-cli` to read `.env.local` automatically

### "Access denied" when running `vercel link`

- Contact team lead to be added to the Vercel team
- Make sure you're logged in: `vercel login`

### Database connection fails

- Verify your `DATABASE_URL` in `.env.local` matches the Vercel output
- Try pulling fresh environment variables: `vercel env pull`
- Check that you're using the staging database connection string (local dev uses staging DB)

### Prisma client not found

- Run `npm run db:generate` after schema changes
- Make sure you've run `npm install` to install all dependencies

## üìÅ Environment Files

- `.env.local` - Your local environment variables (Next.js runtime + database) - **Never commit this**
- `.env.development.local` - Generated by Vercel CLI (reference only) - **Never commit this**
- `.env.example` - Template for required variables (committed to git)

**Never commit actual environment files to git.**

## üë• Team Onboarding

### New Developer Setup

1. **Install Prerequisites:**
   ```bash
   npm install -g vercel
   ```

2. **Get Access:**
   - Contact team lead to be added to the Vercel team
   - Get Auth0 credentials from team lead

3. **Clone and Setup:**
   ```bash
   git clone [repo]
   cd pokemon-marketplace
   npm install
   ```

4. **Environment Variables:**
   ```bash
   vercel link
   vercel env pull
   # Copy DATABASE_URL from .env.development.local to .env.local
   # Get other environment variables from team lead
   ```

5. **Database Setup:**
   ```bash
   npm run db:generate
   npm run db:migrate
   npm run db:seed  # Optional test data
   ```

6. **Start Development:**
   ```bash
   npm run dev
   ```

## üìã Development Workflow

1. Create feature branch from `main`
2. Make changes and test locally
3. Run linting: `npm run lint`
4. Format code: `npm run format`
5. Create pull request
6. Code review and approval
7. Merge to `main` triggers staging deployment
8. Manual promotion to production

## üîó Links

- **Jira Project**: https://pokemonmarketplace.atlassian.net/jira/software/projects/PM
- **Figma Designs**: [Link to be added]
- **Staging Environment**: [Link to be added]
- **Production**: [Link to be added]

## üìû Support

For questions or issues, please create a ticket in our [Jira project](https://pokemonmarketplace.atlassian.net) or reach out in the #dev Slack channel.

## ü§ù Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md) for details on our development process, coding standards, and how to submit pull requests.

## üìö Learn More

To learn more about Next.js and the technologies used in this project:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial
- [Next.js GitHub repository](https://github.com/vercel/next.js) - feedback and contributions welcome
- [NextAuth.js Documentation](https://next-auth.js.org/) - authentication for Next.js
- [Prisma Documentation](https://www.prisma.io/docs) - modern database toolkit
- [Stripe Connect Documentation](https://stripe.com/docs/connect) - marketplace payments

## üöÄ Deployment

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new) from the creators of Next.js.

Check out the [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.
